package org.opensourceway.uvp.pojo.osv;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import org.opensourceway.uvp.enums.OsvSchemaVersion;

import java.util.List;
import java.util.Map;
import java.util.Objects;

/**
 * <a href="https://ossf.github.io/osv-schema/">osv-schema</a> vulnerability
 */
@JsonIgnoreProperties(ignoreUnknown = true)
@JsonInclude(JsonInclude.Include.NON_EMPTY)
public class OsvVulnerability {

    @JsonProperty(value = "schema_version")
    private OsvSchemaVersion schemaVersion;

    @JsonProperty(required = true)
    private String id;

    @JsonProperty(required = true)
    private String modified;

    private String published;

    private String withdrawn;

    private List<String> aliases;

    private List<String> related;

    private String summary;

    private String details;

    private List<OsvSeverity> severity;

    private List<OsvAffected> affected;

    private List<OsvReference> references;

    private List<OsvCredit> credits;

    @JsonProperty("database_specific")
    private Map<Object, Object> databaseSpecific;

    public OsvSchemaVersion getSchemaVersion() {
        return schemaVersion;
    }

    public void setSchemaVersion(OsvSchemaVersion schemaVersion) {
        this.schemaVersion = schemaVersion;
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getModified() {
        return modified;
    }

    public void setModified(String modified) {
        this.modified = modified;
    }

    public String getPublished() {
        return published;
    }

    public void setPublished(String published) {
        this.published = published;
    }

    public String getWithdrawn() {
        return withdrawn;
    }

    public void setWithdrawn(String withdrawn) {
        this.withdrawn = withdrawn;
    }

    public List<String> getAliases() {
        return aliases;
    }

    public void setAliases(List<String> aliases) {
        this.aliases = aliases;
    }

    public List<String> getRelated() {
        return related;
    }

    public void setRelated(List<String> related) {
        this.related = related;
    }

    public String getSummary() {
        return summary;
    }

    public void setSummary(String summary) {
        this.summary = summary;
    }

    public String getDetails() {
        return details;
    }

    public void setDetails(String details) {
        this.details = details;
    }

    public List<OsvSeverity> getSeverity() {
        return severity;
    }

    public void setSeverity(List<OsvSeverity> severity) {
        this.severity = severity;
    }

    public List<OsvAffected> getAffected() {
        return affected;
    }

    public void setAffected(List<OsvAffected> affected) {
        this.affected = affected;
    }

    public List<OsvReference> getReferences() {
        return references;
    }

    public void setReferences(List<OsvReference> references) {
        this.references = references;
    }

    public List<OsvCredit> getCredits() {
        return credits;
    }

    public void setCredits(List<OsvCredit> credits) {
        this.credits = credits;
    }

    public Map<Object, Object> getDatabaseSpecific() {
        return databaseSpecific;
    }

    public void setDatabaseSpecific(Map<Object, Object> databaseSpecific) {
        this.databaseSpecific = databaseSpecific;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        OsvVulnerability that = (OsvVulnerability) o;
        return Objects.equals(id, that.id);
    }

    @Override
    public int hashCode() {
        return Objects.hash(id);
    }
}
